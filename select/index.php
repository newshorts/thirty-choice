<?php
    $lightboxArr = array(
        1 => array('title' => 'Weird without Beer', 'video' => 'http://player.vimeo.com/video/62123282?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),    
        2 => array('title' => 'Budweiser Lizards', 'video' => 'http://player.vimeo.com/video/61393506?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        3 => array('title' => 'Born a Donkey', 'video' => 'http://player.vimeo.com/video/61393505?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        4 => array('title' => 'What Are You Doing?', 'video' => 'http://player.vimeo.com/video/61393507?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        5 => array('title' => 'Aaron Burr', 'video' => 'http://player.vimeo.com/video/61393323?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        6 => array('title' => 'Birthday', 'video' => 'http://player.vimeo.com/video/61393321?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        7 => array('title' => 'Heaven', 'video' => 'http://player.vimeo.com/video/61393319?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        8 => array('title' => 'Peanut Butter Dog', 'video' => 'http://player.vimeo.com/video/62123149?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        9 => array('title' => 'Scented Bus Stops', 'video' => 'http://player.vimeo.com/video/61393320?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        10 => array('title' => 'gettheglass.com', 'video' => 'http://player.vimeo.com/video/61393318?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        11 => array('title' => '2012', 'video' => 'http://player.vimeo.com/video/62123148?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        12 => array('title' => 'Game Time App', 'video' => 'http://player.vimeo.com/video/61393145?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        13 => array('title' => 'Sonic Launch', 'video' => 'http://player.vimeo.com/video/61393142?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        14 => array('title' => 'Polygraph, Birthday, Cows', 'video' => 'http://player.vimeo.com/video/61393139?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        15 => array('title' => 'Rabbit', 'video' => 'http://player.vimeo.com/video/61393136?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        16 => array('title' => 'Save Moolah, Money', 'video' => 'http://player.vimeo.com/video/61393007?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        17 => array('title' => 'The Slowskys', 'video' => 'http://player.vimeo.com/video/61393006?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        18 => array('title' => 'Free Grand Slam', 'video' => 'http://player.vimeo.com/video/61393005?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        19 => array('title' => 'Crash the Super Bowl', 'video' => 'http://player.vimeo.com/video/61393004?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        20 => array('title' => 'Hotel 626', 'video' => 'http://player.vimeo.com/video/61393001?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        21 => array('title' => 'Out the Wazoo, Money...', 'video' => 'http://player.vimeo.com/video/61392326?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        22 => array('title' => 'Toy Boat', 'video' => 'http://player.vimeo.com/video/61392324?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        23 => array('title' => 'Cop', 'video' => 'http://player.vimeo.com/video/61392323?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        24 => array('title' => 'Say No to Plumping', 'video' => 'http://player.vimeo.com/video/61392322?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        25 => array('title' => 'Honey Bees', 'video' => 'http://player.vimeo.com/video/61391864?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        26 => array('title' => 'Five', 'images' => array(
            '../images/print_campaigns/26_HD_Five_1.jpg',
            '../images/print_campaigns/26_HD_Five_2.jpg',
            '../images/print_campaigns/26_HD_Five_3.jpg'
        )), 
        27 => array('title' => 'Astronaut', 'video' => 'http://player.vimeo.com/video/62124087?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),        
        28 => array('title' => 'Francois (Picture Book)', 'video' => 'http://player.vimeo.com/video/61391863?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
/*         29 => array('title' => 'Jay Z', 'video' => 'http://player.vimeo.com/video/61391862?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'), */
        29 => array('title' => 'The Computer is Personal Again', 'video' => '"http://player.vimeo.com/video/62125260?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        30 => array('title' => 'I Want To Say', 'video' => 'http://player.vimeo.com/video/61391859?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        31 => array('title' => 'UFO', 'video' => 'http://player.vimeo.com/video/61391398?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        32 => array('title' => 'Assurance', 'video' => 'http://player.vimeo.com/video/61391397?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        33 => array('title' => 'Practically/Amazing', 'images' => array(
            '../images/print_campaigns/33_ISUZU_1.jpg',
            '../images/print_campaigns/33_ISUZU_2.jpg'
        )),
        34 => array('title' => 'Ivan Cobenk', 'video' => 'http://player.vimeo.com/video/61391396?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        35 => array('title' => 'Mill Valley Film Festival', 'video' => 'http://player.vimeo.com/video/62126748?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        36 => array('title' => 'Birding The Net', 'video' => 'http://player.vimeo.com/video/61391715?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        37 => array('title' => 'Taxi', 'video' => 'http://player.vimeo.com/video/61391393?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        38 => array('title' => 'There Can Only Be One', 'video' => 'http://player.vimeo.com/video/61391144?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        39 => array('title' => 'I Will Have Two Fillings', 'video' => 'http://player.vimeo.com/video/61392869?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        40 => array('title' => 'Skateboarders', 'video' => 'http://player.vimeo.com/video/61391143?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        41 => array('title' => 'Wario Land – Shake It', 'video' => 'http://player.vimeo.com/video/61391139?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        42 => array('title' => 'Fantasies', 'video' => 'http://player.vimeo.com/video/62127500?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        43 => array('title' => 'Neighbors', 'video' => 'http://player.vimeo.com/video/61391138?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        44 => array('title' => 'Long Way Home', 'video' => 'http://player.vimeo.com/video/61391136?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        45 => array('title' => 'See What Develops', 'video' => 'http://player.vimeo.com/video/61392867?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        46 => array('title' => 'Kills Bugs Fast', 'images' => array(
            '../images/print_campaigns/42_Porsche_Kills_Bugs_Fast.jpg'
        )),
        47 => array('title' => 'Ron Stablehorn, Beer Ape', 'video' => 'http://player.vimeo.com/video/61385504?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        48 => array('title' => 'NextFest, Sky Dome', 'video' => 'http://player.vimeo.com/video/61394273?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        49 => array('title' => 'Sheet Metal', 'video' => 'http://player.vimeo.com/video/61385498?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        50 => array('title' => 'SEGA!', 'video' => 'http://player.vimeo.com/video/61385494?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        51 => array('title' => 'Wild Will', 'video' => 'http://player.vimeo.com/video/61385220?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        52 => array('title' => 'Toby', 'video' => 'http://player.vimeo.com/video/61385218?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        53 => array('title' => 'Wedding', 'video' => 'http://player.vimeo.com/video/61392868?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        54 => array('title' => 'Now Network', 'video' => 'http://player.vimeo.com/video/61385217?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
        55 => array('title' => 'Tattoo', 'images' => array(
            '../images/print_campaigns/51_NYer_Tattoo.jpg'
        )),
        56 => array('title' => 'Bus Stop Derby', 'video' => 'http://player.vimeo.com/video/61385215?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff'),
    );
    
    function genId($length = 10) {
        $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
        $randomString = '';
        for ($i = 0; $i < $length; $i++) {
            $randomString .= $characters[rand(0, strlen($characters) - 1)];
        }
        return $randomString;
    }

    function composeGalleryBlock($i, $image_arr, $h) {
        $id = genId(7);

        $length = count($image_arr);

        $str = '';

        for($x = 0; $x < $length; $x++) {
            $str .= '<a class="videoLink fancybox" rel="gallery'.$i .'" href="'.$image_arr[$x].'"></a>';
        }

        $block = <<<BLOCK
    <div class="videoContainer" id="$id">
        <div class="video" data-key="$id" data-heading="$h">
            <img class="videoThumb" src="../images/40x40/$i.jpg" />
            <img class="videoTile" src="../images/150x150/$i.jpg" />
            $str
        </div>
    </div>
BLOCK;
        return $block;
    }

    function composeVimeoBlock($i, $url, $h) {
        $id = genId(7);

        $block = <<<BLOCK
    <div class="videoContainer" id="$id">
        <div class="video" data-key="$id" data-heading="$h">
            <img class="videoThumb" src="../images/40x40/$i.jpg" />
            <img class="videoTile" src="../images/150x150/$i.jpg" />
            <a class="videoLink fancybox-media" href="$url"></a>
        </div>
    </div>
BLOCK;
        return $block;
    }

    function outputBlock($lb) {

        $length = count($lb);

        for($i = 1; $i <= 52; $i++) {

            if(isset($lb[$i]['images'])) {
                $image_arr = $lb[$i]['images'];
                $h = $lb[$i]['title'];
                $block = composeGalleryBlock($i, $image_arr, $h);
            } else {
                $url = $lb[$i]['video'];
                $h = $lb[$i]['title'];
                $block = composeVimeoBlock($i, $url, $h);
            }

            echo $block;
        }
    }
?>
<!-- 
    Author: Mike Newell © 2012
-->
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title>GSP 30th Anniversary Top 10</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" type="text/css" href="../css/reset.css" />
        <link rel="stylesheet" type="text/css" href="../css/style.css" />
        <link rel="stylesheet" type="text/css" href="../css/select.css" />
        <link href="http://agency.goodbysilverstein.com/30th/favicon.ico" rel="shortcut icon">
        <style>
            
        </style>
    </head>
    <body>
        <div id="wrap">
            <hr class="redBar" />
            <div id="container">
                <header>
                    <a href="http://agency.goodbysilverstein.com/30th/"><img src="../images/logo.png" /></a>
                    <hr />
                    <div class="nav"></div>
                </header>
                <section>
                    <header><h1>How to Vote</h1></header>
                    <article>
                        <p>1. CLICK a tile to view the work.</p>
                        <p>2. To vote, DRAG your favorites to Your Top 10 list on the right.</p>
                        <p>3. You can re-order before you submit.</p>
                        <p>4. There is space below for "write-in" votes.</p> 
                        <p><span class="strong_red">Votes are due by 5:00 p.m. PDT, Monday, March 25.</span></p>
                    </article>
                    <article>
                        <div class="videos">
                            
                            <?php outputBlock($lightboxArr); ?>
                            
                            <div class="clear"></div>
                        </div>
                        <ul class="choices">
                            <h2><strong>Your Top 10</strong></h2>
                            <li class="choice">
                                <!-- TODO added choiceDropContainer which doesn't seem to be working for z-indexes -->
                                <div class="choiceDropContainer">
                                    <div class="choiceDrop empty"></div>
                                </div>
                                <span>1.</span>
                                <div class="choiceTitle"><p></p></div>
                                <div class="clear"></div>
                            </li>
                            <li class="choice">
                                <div class="choiceDropContainer">
                                    <div class="choiceDrop empty"></div>
                                </div>
                                <span>2.</span>
                                <div class="choiceTitle"><p></p></div>
                                <div class="clear"></div>
                            </li>
                            <li class="choice">
                                <div class="choiceDropContainer">
                                    <div class="choiceDrop empty"></div>
                                </div>
                                <span>3.</span>
                                <div class="choiceTitle"><p></p></div>
                                <div class="clear"></div>
                            </li>
                            <li class="choice">
                                <div class="choiceDropContainer">
                                    <div class="choiceDrop empty"></div>
                                </div>
                                <span>4.</span>
                                <div class="choiceTitle"><p></p></div>
                                <div class="clear"></div>
                            </li>
                            <li class="choice">
                                <div class="choiceDropContainer">
                                    <div class="choiceDrop empty"></div>
                                </div>
                                <span>5.</span>
                                <div class="choiceTitle"><p></p></div>
                                <div class="clear"></div>
                            </li>
                            <li class="choice">
                                <div class="choiceDropContainer">
                                    <div class="choiceDrop empty"></div>
                                </div>
                                <span>6.</span>
                                <div class="choiceTitle"><p></p></div>
                                <div class="clear"></div>
                            </li>
                            <li class="choice">
                                <div class="choiceDropContainer">
                                    <div class="choiceDrop empty"></div>
                                </div>
                                <span>7.</span>
                                <div class="choiceTitle"><p></p></div>
                                <div class="clear"></div>
                            </li>
                            <li class="choice">
                                <div class="choiceDropContainer">
                                    <div class="choiceDrop empty"></div>
                                </div>
                                <span>8.</span>
                                <div class="choiceTitle"><p></p></div>
                                <div class="clear"></div>
                            </li>
                            <li class="choice">
                                <div class="choiceDropContainer">
                                    <div class="choiceDrop empty"></div>
                                </div>
                                <span>9.</span>
                                <div class="choiceTitle"><p></p></div>
                                <div class="clear"></div>
                            </li>
                            <li class="choice" id="ten">
                                <div class="choiceDropContainer">
                                    <div class="choiceDrop empty"></div>
                                </div>
                                <span>10.</span>
                                <div class="choiceTitle"><p></p></div>
                                <div class="clear"></div>
                            </li>
<!--                            
                            NOTE: THIS WILL KILL THE PAGE FIND ANOTHER PLACE FOR FORM
-->                            <li>
                                <form method="post" name="choicesForm" class="choicesForm">
                                    <label for="comments">Comments:</label>
                                    <br />
                                    <textarea class="comments" rows="3" cols="10" placeholder="Feel free to write-in another campaign or share thoughts on any of your votes." value=""></textarea>
                                    <div id="submit_select" >
                                    	<a href="#" target="blank">Submit Your Rankings</a>
                                    </div>
                                </form>
                            </li>
                        </ul>
                        <div class="clear"></div>
                    </article>
                </section>
            </div><!-- end container -->
        </div><!-- end wrap -->
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/jquery-ui.min.js"></script>
        
        <!-- Add mousewheel plugin (this is optional) -->
	<script type="text/javascript" src="../lib/jquery.mousewheel-3.0.6.pack.js"></script>

	<!-- Add fancyBox main JS and CSS files -->
	<script type="text/javascript" src="../source/jquery.fancybox.js?v=2.1.4"></script>
	<link rel="stylesheet" type="text/css" href="../source/jquery.fancybox.css?v=2.1.4" media="screen" />

	<!-- Add Button helper (this is optional) -->
	<link rel="stylesheet" type="text/css" href="../source/helpers/jquery.fancybox-buttons.css?v=1.0.5" />
	<script type="text/javascript" src="../source/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>

	<!-- Add Thumbnail helper (this is optional) -->
	<link rel="stylesheet" type="text/css" href="../source/helpers/jquery.fancybox-thumbs.css?v=1.0.7" />
	<script type="text/javascript" src="../source/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>

	<!-- Add Media helper (this is optional) -->
	<script type="text/javascript" src="../source/helpers/jquery.fancybox-media.js?v=1.0.5"></script>
        
        <script src="../js/cufon.js"></script>
        <script src="../js/berthold.js"></script>
        <script src="../js/jquery.cookie.js"></script>
        <script src="../js/class.js"></script>
        <script src="../js/app.js"></script>
        <script src="../js/choices.js"></script>
        <script>
            (function($) {
                $(window).load(function() {
                    
                    var app = new App('.choicesForm'),
                        c = new Choices();
                    
/*                     Cufon.replace('h1, p, h2'); */
                    
                    $('.fancybox-media')
                    .attr('rel', 'media-gallery')
                    .fancybox({
                        openEffect : 'none',
                        closeEffect : 'none',
                        prevEffect : 'none',
                        nextEffect : 'none',

                        arrows : false,
                        helpers : {
                            media : {},
                            buttons : {}
                        }
                    });
                    
                    $(".fancybox").fancybox({
                        openEffect	: 'none',
                        closeEffect	: 'none'
                    });
                    
                    $(window).scroll(function(){
                        if  ($(window).scrollTop() >= 300){
                            $('.choices').css({
                                position: 'fixed',
                                margin: '-2533px 0 0 667px'
                            });
                            /*margin: -2150px 0 0 667px;*/
                        }
                        
                        if  ($(window).scrollTop() < 300){
                            $('.choices').css({
                                position: 'relative',
                                margin: '-2135px -213px 0 0'
                            });
                            /*margin: -2150px 0 0 667px;*/
                        }
                    });
                    
                    $('#submit_select').on('click', function(evt) {
                        console.log('here');
                        evt.preventDefault();
                        
                        var r = confirm("Are you sure you want to submit this ranked list?")
                        
                        if(r == true) {
                            var contactData = app.readCookie('GSP_contact_data');

                            var choicesData = new Array();
                            $('.choiceTitle').each(function(idx) {
                                var p = $(this).find('p');
                                var title = p.text();
                                var key = idx + 1;

                                choicesData[key] = title;
                            });
                            var obj = {
                                contact: contactData,
                                choices: choicesData,
                                comments: $('.comments').val()
                            };

                            var json = JSON.stringify(obj);

                            $.cookie('GSP_vote_data', json, { expires: 7 });

                            $.post("submit.php", { "data": json },
                                function(data){
                                    console.dir(data);

                                    if(data.response) {
                                        $.removeCookie('GSP_vote_data');
                                        $.removeCookie('GSP_contact_data');
                                        window.location = "http://agency.goodbysilverstein.com/30th/thanks";
                                    } else {
                                        alert('Unable to contact our servers right now, please try again later.')
                                    }

                                }, "json");
                        }
                        
                            
                        
                    });
                    
                });
            })(jQuery);
        </script>
    </body>
</html>
